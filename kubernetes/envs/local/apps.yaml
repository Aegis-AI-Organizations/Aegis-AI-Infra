apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: aegis-agent-proto
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/Aegis-AI-Organizations/Aegis-AI-Infra.git
    targetRevision: HEAD
    path: kubernetes/charts/aegis-service
    helm:
      valueFiles:
        - ../../envs/local/values/agent-values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: aegis-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: aegis-api-gateway
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/Aegis-AI-Organizations/Aegis-AI-Infra.git
    targetRevision: HEAD
    path: kubernetes/charts/aegis-service
    helm:
      valueFiles:
        - ../../envs/local/values/api-gateway-values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: aegis-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: aegis-attack-worker
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/Aegis-AI-Organizations/Aegis-AI-Infra.git
    targetRevision: HEAD
    path: kubernetes/charts/aegis-service
    helm:
      valueFiles:
        - ../../envs/local/values/attack-worker-values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: aegis-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: aegis-brain
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/Aegis-AI-Organizations/Aegis-AI-Infra.git
    targetRevision: HEAD
    path: kubernetes/charts/aegis-service
    helm:
      valueFiles:
        - ../../envs/local/values/brain-values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: aegis-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: aegis-dashboard
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/Aegis-AI-Organizations/Aegis-AI-Infra.git
    targetRevision: HEAD
    path: kubernetes/charts/aegis-service
    helm:
      valueFiles:
        - ../../envs/local/values/dashboard-values.yaml
  destination:
    server: https://kubernetes.default.svc
    namespace: aegis-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: aegis-postgres
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://charts.bitnami.com/bitnami
    chart: postgresql
    targetRevision: 15.x.x
    helm:
      valueFiles:
        # Note: in real prod, use valuesObject or direct helm registry with specific versions
      valuesObject:
        global:
          postgresql:
            auth:
              database: aegis_db
              username: aegis_admin
              password: "password123"
        primary:
          persistence:
            enabled: false
  destination:
    server: https://kubernetes.default.svc
    namespace: aegis-system
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
